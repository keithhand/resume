\documentclass[10pt,a4paper]{letter}
\usepackage[margin=1in]{geometry}

\newcommand{\covername}{
  \thiscovername
}

\newcommand{\targetposition}{
  \thistargetposition
}

\newcommand{\targetcompany}{
  \thistargetcompany
}

\newcommand{\coveropening}{
  \thiscoveropening\hspace{-3pt},
}

\newcommand{\coverclosing}{
  \thiscoverclosing\hspace{-3pt},
}

\newcommand{\intro}{
  \thisintro
}

\newcommand{\body}{
  \thisbody
}

\newcommand{\outro}{
  \thisoutro
}

\input{cover-info}

\newcommand{\separator}{

  \vspace{-.5em}
  \ldots

}

\begin{document}
\begin{letter}{\targetcompany\\Re:\targetposition}
  \pagestyle{plain}
  \signature{\vspace{-4em}\covername}
  \opening{\coveropening}

  \directlua{
    local intro = "\intro"
    local body = "\body"
    local outro = "\outro"
    local defaultLen = 3

    if string.len(intro) >= defaultLen then
      tex.print(intro, "\\separator")
    end
    if string.len(body) >= defaultLen then
      tex.print(body)
      if string.len(outro) >= defaultLen then
        tex.print("\\separator")
      end
    end
    tex.print(outro)
  }

  \vspace{2em}
  \closing{\coverclosing}
\end{letter}
\end{document}
